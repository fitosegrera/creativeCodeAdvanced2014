Image Processing
================

**Image processing experiment using python** The program takes a word and searches for 40 images related to it using Google's API. It the takes 1000 pixels from each image (random positions) and generates a new image based on those.

####Video Demo

[![thumb.png](/week3/imageProcessing/thumb.png)](https://www.youtube.com/watch?v=KpD7MqYX5Ew)

Click on the image to watch the video

####Contents

On the project you will find 3 .py files:

**main.py** --> is the mainn script, it is the one that has to be run. Basically this script calls and executes the function of the class **googleImg** that I wrote in a separate file, just to keep it clean.

**googleImg.py**--> Contains a class that uses the google API to search for a given word and return a JSON that then gets parsed to get only images. This file calls a second class I wrote called **generativeImg** that does the rest of the job.

**generativeImg.py** --> Contains a class with a function that loads all the images downloaded using the googleImg class and grabs 1000 pixels at random pisitions from each image. Then it generates a new image with the extracted pixels.

**folder fitosegrera** --> Contains all the downloaded images from the google image search. The folder is created dynamically and takes as a name the word that is being searched.

**test** is the new image generated by the program.

####The Result

![test.jpg](/week3/imageProcessing/test)

####The Code

**main.py**

	from googleImg import googleImg

	#Create an instance of the class "googleImg" and execute the "searchAndDownload" function
	results = googleImg()
	results.searchAndDownload("fitosegrera")


**googleImg.py**

	import urllib2
	import simplejson
	import urllib
	import os

	from generativeImg import generativeImg
	imageGen = generativeImg()

	class googleImg:

		def searchAndDownload(self, q):
			numOfImgs = 10
			urls = []

			url = ('https://ajax.googleapis.com/ajax/services/search/images?v=1.0&q=barack%20obama&userip=INSERT-USER-IP')

			searchTerm = q
			os.makedirs(searchTerm)

			request = urllib2.Request(url)
			response = urllib2.urlopen(request)

			# Set count to 0
			count= 0

			for i in range(0,numOfImgs):
			    #request a new set of images for each loop
			    url = ('https://ajax.googleapis.com/ajax/services/search/images?' + 'v=1.0&q='+searchTerm+'&start='+str(i*4)+'&userip=MyIP')
			    print url
			    request = urllib2.Request(url, None, {'Referer': 'testing'})
			    response = urllib2.urlopen(request)

			    # Get the complete JSON
			    results = simplejson.load(response)
			    data = results['responseData']
			    dataInfo = data['results']

			    # Iterate for each result and get the element unescaped url from the JSON
			    for myUrl in dataInfo:
			        print myUrl['unescapedUrl']
			        image = urllib.URLopener()
			        image.retrieve(myUrl['unescapedUrl'], searchTerm+"/"+str(count)+".jpg")
			        urls.append(searchTerm+"/"+str(count)+".jpg" )
			        count = count + 1

			imageGen.generate(urls, searchTerm)  


**generativeImg.py**

	import Tkinter
	from PIL import Image, ImageDraw, ImageTk
	from random import randint

	class generativeImg:

	  def generate(self, urls, q):

	    print urls
	    generalCount = 0
	    countX = 0
	    countY = 0
	    savePosX = 0
	    savePosY = 0
	    pixRange = 2500

	    size = (500,200)
	    newIm = Image.new('RGB', size, (0,0,0)) # create the image
	    draw = ImageDraw.Draw(newIm)

	    for items in urls:

	      im = Image.open(q+"/"+str(generalCount)+".jpg")
	      rgb_im = im.convert('RGB')
	      width, height = im.size
	      print "Size of image: "+str(im.size)

	      for pix in range(pixRange):
	        r, g, b = rgb_im.getpixel((randint(1,width-1), randint(1,height-1)))
	        print "RGB Values of pixel: "+ str(r),str(g),str(b)
	        draw.point((countX,countY), fill=(r,g,b))
	        if countX > width:
	          countX = 0
	          countY +=1
	        countX+=1
	      generalCount+=1

	    newIm.show()
	    newIm.save("test", "JPEG")

